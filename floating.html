<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Floating Money</title>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <style>
        body { font-family: sans-serif; background: #e0f7fa; padding: 20px; margin: 0; }
        .container { max-width: 500px; margin: 0 auto; }
        .card { background: white; padding: 15px; border-radius: 10px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        h2 { margin-top: 0; color: #006064; text-align: center; }
        input, select, button { width: 100%; padding: 12px; margin-bottom: 10px; box-sizing: border-box; border: 1px solid #ccc; border-radius: 8px; font-size: 16px; }
        button { background: #00bcd4; color: white; border: none; font-weight: bold; cursor: pointer; }
        .summary { display: flex; justify-content: space-between; font-weight: bold; }
        .in { color: green; } .out { color: red; }
        .record { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #eee; align-items: center; }
        .tag { padding: 3px 8px; border-radius: 4px; font-size: 0.7rem; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <h2>ðŸ’° Floating Money</h2>
            <div class="summary">
                <div style="text-align:center">IN<br><span id="sum-in" class="in">0</span></div>
                <div style="text-align:center">OUT<br><span id="sum-out" class="out">0</span></div>
                <div style="text-align:center">BALANCE<br><span id="sum-bal" style="color:#333">0</span></div>
            </div>
        </div>

        <div class="card">
            <input id="f-person" placeholder="Waiter / Handler Name">
            <input id="f-desc" placeholder="Description (e.g. Coffee Base)">
            <input type="number" id="f-amt" placeholder="Amount">
            <select id="f-type">
                <option value="in">Money IN (Deposit)</option>
                <option value="out">Money OUT (Expense/Change)</option>
            </select>
            <button onclick="addFloat()">Record Transaction</button>
        </div>

        <div class="card">
            <h3>Today's Log</h3>
            <div id="log-list"></div>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAKqsixs_luzjqCY1ZCqrKRtn77wcJs5Iw",
            authDomain: "bean-5a113.firebaseapp.com",
            projectId: "bean-5a113",
            storageBucket: "bean-5a113.firebasestorage.app",
            messagingSenderId: "702927377502",
            appId: "1:702927377502:web:9e50192a0c431da69850cf"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        const today = new Date().toISOString().split('T')[0];

        function addFloat() {
            const p = document.getElementById('f-person').value;
            const d = document.getElementById('f-desc').value;
            const a = parseFloat(document.getElementById('f-amt').value);
            const t = document.getElementById('f-type').value;

            if(!p || !d || !a) return alert("Fill all fields");

            db.collection('floating').add({
                person: p, description: d, amount: a, type: t, date: today, ts: Date.now()
            }).then(() => {
                document.getElementById('f-desc').value = '';
                document.getElementById('f-amt').value = '';
            });
        }

        db.collection('floating').where('date', '==', today).orderBy('ts', 'desc').onSnapshot(snap => {
            let tin = 0, tout = 0, html = '';
            snap.forEach(doc => {
                const d = doc.data();
                if(d.type === 'in') tin += d.amount; else tout += d.amount;
                html += `
                    <div class="record">
                        <div>
                            <span class="tag" style="background:${d.type=='in'?'green':'red'}">${d.type.toUpperCase()}</span>
                            <strong>${d.person}</strong>: ${d.description}
                        </div>
                        <div style="text-align:right">
                            <span style="font-weight:bold">${d.amount}</span><br>
                            <small onclick="del('${doc.id}')" style="color:#aaa; cursor:pointer">delete</small>
                        </div>
                    </div>`;
            });
            document.getElementById('sum-in').innerText = tin;
            document.getElementById('sum-out').innerText = tout;
            document.getElementById('sum-bal').innerText = tin - tout;
            document.getElementById('log-list').innerHTML = html || '<p style="text-align:center;color:#ccc">No records today</p>';
        });

        function del(id) {
            if(confirm("Remove this entry?")) db.collection('floating').doc(id).delete();
        }
    </script>
</body>
</html>
